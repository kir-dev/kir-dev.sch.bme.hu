---
layout: post
author: abel
idp: zoww
date: 2014-07-20 22:10:00 CEST
title: "Facebook HipHop"
comment: true
---

A Facebook még márciusban hivatalosan is elérhetővé tette a [Hack](http://hacklang.org)-et, az első, saját maguk által fejlesztett programozási nyelvet. A cég vélhetően a világ legnagyobb PHP felhasználója, de az elmúlt néhány évben szép lassan kezdtek elfordulni a PHP 5-től és saját fejlesztésbe kezdtek, hogy gyorsítsanak a rendszereiken.

## A HipHop története

A Facebook az első lépést a HPHPc bevezetésével kezdte. Ez egy olyan fordító volt, ami a hatalmas mennyiségű PHP kódjukat C++ kóddá alakította, értelmezte, majd fordította. Az egész folyamat akár több óráig is tarthatott, és habár hozott észrevehető mértékű sebességnövekedést, a fejlesztőket érő negatív hatása lényegesen nagyobb volt. Emellett párhuzamosan fejlesztették a HPHPi-t és a HPHPd-t. Az előbbi a HPHPc belső felhasználású, fejlesztői változata volt és nem kellett a futásához a komplett kódbázist lefordítani minden egyes alkalommal. Az utóbbi pedig a család debuggere.

A HPHPc egészen jó kiindulási alapnak tűnt. Érezhetően felgyorsította a Facebookot és lehetőséget adott a növekedésre ugyanazon a hardveren. Sajnos azonban csak a PHP 5.2-es verziójára épült és mindössze egy töredék részét fedte le a nyelvnek (például nem lehetett dinamikusan függvényeket létrehozni a [*create_function()*](http://php.net/manual/en/function.create-function.php)-nel).

Ahhoz, hogy a gyermekbetegségeken túllépjenek egy új eszközre volt szükségük, így végül 2011-ben bemutatták az első szabadon hozzáférhető bétát a HipHop Virtual Machine-ból (HHVM). Ezzel egyidőben a HPHP család fejlesztését fel is függesztették. A HHVM egy Just In Time (JIT) fordító, ami lehetőséget biztosít a PHP kódok valósidejű gépi kóddá fordítására.

A HHVM első kiadása majdnem 100%-ig kompatibilis volt a PHP 5.4-es verziójával és a folyamatos fejlesztések miatt belekerültek az 5.5-ös (és a későbbi verziók) újdonságai is. A hibákkal együtt! A HHVM fejlesztői azt nyilatkozták, hogy készíthettek volna “tökéletes” PHP implementációt, de ehelyett átvették a hibákat is, hogy a későbbi migrációs feladatok a lehető legegyszerűbbek legyenek. Folyamatosan javítják azonban az olyan hibákat, amik nem sértik nagymértékben a visszafelé kompatibilitást.

## HHVM vs PHP

A HHVM gyorsabb, sokkal gyorsabb a legtöbb esetben, de a sebesség korántsem minden. Sokan a teljesítmény növekedését emlegetik az összehasonlításkor, de több lényeges dolog is van, amit érdemes számításba venni.

### Környezeti hatás

A HHVM 2.3-as verziójával bevezették a FastCGI támogatást. Ez azt jelenti, hogy azoknak, akik eddig a php-fpm-et használták, a HHVM egy jó alternatíva lehet. Továbbá lehetőség van egymás mellett futtatni a sima PHP-t és a HHVM-et úgy, hogy a különböző útvonalakat különböző FastCGI proxik dolgozzák fel.

*Az Ubuntu 12.04/13.10-hez, Debian 7-hez, vagy a Fedora 20-hoz közvetlenül érhetőek el a HHVM fejlesztői csapatától származó csomagok.*

A legnagyobb hátrány jelenleg, hogy a standard PHP bővítményeket a HHVM nem támogatja. Tehát például a PECL bővítmények nagy valószínűséggel nem lesznek kompatibilisek a HHVM-mel. A fejlesztők nagy erőkkel dolgoznak azon, hogy ezek közül a népszerűbbeket kompatibilissé tegyék.

### Közösségi hatás

Néhányan úgy gondolják, hogy a HHVM megjelenése szétválasztja majd a PHP közösséget. Természetesen ez akár igaz is lehet, de a HHVM fejlesztő csapata igyekszik, hogy a standard PHP-ba is átkerüljenek az általuk fejlesztett újdonságok. Egy jó példa erre a [generátorok](http://php.net/generators), ami először a HHVM-ben jelent meg, majd később a PHP 5.5 is átvette.

### Hack

Míg a legtöbben a HHVM-re úgy gondolnak, mint egy alternatív környezetre a PHP-hoz, valójában a Facebook saját programozási nyelvéhez, a Hack-hez készült. A Hacket a PHP testvéreként lehetne a legjobban bemutatni. A szintaxis közel azonos, de a lényeg, hogy támogat olyan kiváló dolgokat, mint a generikusság, vagy a változók típus definíciója mind a bemeneti, mind a visszatérési oldalon. Meg persze egy csomó más érdekességet.

A Hack használható vegyesen a PHP-val, de az igazi erejét akkor mutatja meg, ha a HHVM statikus módjával közösen használják. Ekkor ugyanis valós időben szól olyan hibákért, mint például a típus eltérések. Fontos különbség a PHP-val szemben, hogy a Hack-et nem lehet sima HTML-lel keverni (míg a PHP-t igen).

Végezetül a Hack kiváló színtere lehet a PHP fejlődési irányának elndöntéséhez és remélhetőleg ennek köszönhetően sok új fejlesztést láthatunk majd viszont a standard PHP-ban is.